# SecureShield üõ°Ô∏è

**SecureShield** ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è PHP, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞—Ç–∞–∫, —Ç–∞–∫–∏—Ö –∫–∞–∫ **SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏**, **XSS**, **CSRF**, **Command Injection**, **PHP Injection** –∏ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö.

–≠—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é –∑–∞—â–∏—Ç—É "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" –∏ –ª—ë–≥–∫—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ –ª—é–±–æ–π PHP-–ø—Ä–æ–µ–∫—Ç. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –ª–∏ –≤—ã –Ω–∞–¥ –Ω–µ–±–æ–ª—å—à–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º –∏–ª–∏ –∫—Ä—É–ø–Ω—ã–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, SecureShield —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–∏–º –Ω–∞–¥–µ–∂–Ω—ã–º —â–∏—Ç–æ–º –æ—Ç –∞—Ç–∞–∫.

---

## üî• **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**

- ‚úÖ **SQL Injection Protection** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PDO –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π.
- ‚úÖ **XSS Protection** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ JavaScript —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.
- ‚úÖ **CSRF Protection** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ CSRF-—Ç–æ–∫–µ–Ω–æ–≤.
- ‚úÖ **Command Injection Protection** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥.
- ‚úÖ **LDAP Injection Protection** ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∞—Ç–∞–∫ –Ω–∞ LDAP-–∑–∞–ø—Ä–æ—Å—ã.
- ‚úÖ **Open Redirect Protection** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏—à–∏–Ω–≥–æ–≤—ã—Ö –∞—Ç–∞–∫.
- ‚úÖ **Session Fixation Protection** ‚Äî —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Å–µ—Å—Å–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ñ–∏–∫—Å–∞—Ü–∏–∏.
- ‚úÖ **Firewall** ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö User-Agent'–æ–≤.
- ‚úÖ **Rate Limiting** ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DoS-–∞—Ç–∞–∫.
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥ –ª—é–±–æ–π –ø—Ä–æ–µ–∫—Ç.
- ‚úÖ **–õ—ë–≥–∫–æ—Å—Ç—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏** ‚Äî —É–¥–æ–±–Ω—ã–π API, –∫–æ—Ç–æ—Ä—ã–π —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.

---

## üì¶ **–£—Å—Ç–∞–Ω–æ–≤–∫–∞**

### –ß–µ—Ä–µ–∑ Composer (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ Composer –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
composer require ILIASMORSEL/secure-shield
```


## üì¶ **–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞**

–°–∫–∞—á–∞–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Å GitHub.
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª src/SecureShield.php –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç.
–ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ñ–∞–π–ª –≤ —Å–≤–æ—ë–º –∫–æ–¥–µ:

```bash
require_once 'path/to/SecureShield.php';
```

## üöÄ **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**

–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SecureShield:

```bash
use SecureShield\SecureShield;


// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
$db = new PDO('mysql:host=localhost;dbname=test', 'root', 'password');

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
$config = [
    'csrf_token_lifetime' => 3600, // –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ CSRF-—Ç–æ–∫–µ–Ω–∞
    'allowed_redirect_hosts' => ['trusted.com', 'example.com'], // –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
    'rate_limit' => [
        'enabled' => true,
        'requests_per_minute' => 100, // –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
    ],
];

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
$shield = SecureShield::init($db, $config);

// SQL-–∏–Ω—ä–µ–∫—Ü–∏—è: –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
$query = "SELECT * FROM users WHERE username = :username";
$params = ['username' => $_POST['username']];
$result = $shield->dbQuery($query, $params)->fetchAll();

// –ó–∞—â–∏—Ç–∞ –æ—Ç XSS
echo $shield->escapeHTML('<script>alert("XSS!")</script>');

// CSRF: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
$csrfToken = $shield->generateCSRFToken();
if ($_POST) {
    $shield->validateCSRFToken($_POST['csrf_token']); // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
}

// –ó–∞—â–∏—Ç–∞ –æ—Ç Open Redirect
$safeUrl = $shield->validateRedirect('https://trusted.com/page');
```

## üõ°Ô∏è **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**

### SQL Injection Protection

```bash
$query = "SELECT * FROM users WHERE email = :email";
$params = ['email' => $_POST['email']];
$result = $shield->dbQuery($query, $params)->fetchAll();
```

–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è.
–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ –±–∞–∑—É.

### XSS Protection

```bash
echo $shield->escapeHTML('<script>alert("XSS!")</script>');
```

–ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (<, >, ", ') –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ HTML-—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ã.
–ó–∞—â–∏—Ç–∞ –æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ JavaScript.

### CSRF Protection

```bash
$csrfToken = $shield->generateCSRFToken();
if ($_POST) {
    $shield->validateCSRFToken($_POST['csrf_token']);
}
```

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ CSRF-—Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã —Ñ–æ—Ä–º –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏.

### Command Injection Protection

```bash
$command = $shield->sanitizeCommand('ls');
exec($command);
```

### Open Redirect Protection

```bash
$safeUrl = $shield->validateRedirect('https://trusted.com/page');
```

## üõ†Ô∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**

### –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
$config = [
    'csrf_token_lifetime' => 3600,
    'allowed_redirect_hosts' => ['trusted.com', 'example.com'],
    'rate_limit' => [
        'enabled' => true,
        'requests_per_minute' => 100,
    ],
    'firewall' => [
        'block_user_agents' => ['sqlmap', 'curl', 'bot'], // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ User-Agent'—ã
        'block_ips' => ['192.168.1.100'], // –ë–ª–æ–∫–∏—Ä—É–µ–º –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ IP
    ],
];
```

## üìÇ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```bash
SecureShield/
‚îú‚îÄ‚îÄ examples/                # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ basic-usage.php
‚îÇ   ‚îî‚îÄ‚îÄ advanced-usage.php
‚îú‚îÄ‚îÄ src/                     # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ SecureShield.php
‚îú‚îÄ‚îÄ tests/                   # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ SecureShieldTest.php
‚îú‚îÄ‚îÄ README.md                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ CHANGELOG.md             # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îú‚îÄ‚îÄ LICENSE                  # –õ–∏—Ü–µ–Ω–∑–∏—è
‚îú‚îÄ‚îÄ composer.json            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Composer
‚îî‚îÄ‚îÄ .gitignore               # –§–∞–π–ª—ã, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ Git
```

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

SecureShield —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT License.

## üöÄ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

–î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç XXE (XML External Entities).
–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ (Laravel, Symfony).
–£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤.

## ü§ù **–í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç**

–ú—ã –æ—Ç–∫—Ä—ã—Ç—ã –∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º –∏ —É–ª—É—á—à–µ–Ω–∏—è–º! –ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –±–∞–≥ –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ, —Å–æ–∑–¥–∞–π—Ç–µ issue –∏–ª–∏ —Å–¥–µ–ª–∞–π—Ç–µ pull request. –ú—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–¥—ã –≤–∞—à–µ–º—É —É—á–∞—Å—Ç–∏—é! ‚ù§Ô∏è

–ï—Å–ª–∏ –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ —á–µ—Ä–µ–∑ Ko-fi:

[![Support me on Ko-fi](https://ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/iliasmorsel)

 
